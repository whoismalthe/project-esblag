<!doctype html>
<html lang="da">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Project ESBLAG ‚Äî MVP</title>

    <!--
      Project ESBLAG (Education Should Be Like A Game) ‚Äî MVP
      ------------------------------------------------------
      Single-file web app built with plain HTML/CSS/JS so you can host it easily
      on GitHub Pages, Replit, or any static host. No build tools required.

      WHAT'S INCLUDED
      - Welcome screen
      - Simple auth (name + age) saved to localStorage
      - 10-question multiple-choice quiz
      - XP + Level system (10 XP per correct answer, 50 XP per level)
      - Cute "pet" indicator that evolves with level
      - Retry quiz + logout

      HOW TO EXTEND (quick ideas)
      - Add more quizzes by pushing into the QUESTIONS array or loading from JSON
      - Add badges when levels are reached
      - Hook up to a backend later (keep the user object shape)
      - Replace the emoji pet with images/animations
    -->

    <!-- Friendly, playful font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400..700&family=Nunito:wght@300;400;600;800&display=swap" rel="stylesheet">

    <style>
      :root{
        --bg: #fbfbff;
        --ink: #16213e;
        --muted: #667085;
        --brand: #6c5ce7;   /* playful purple */
        --brand-2: #00c2ff; /* sky */
        --brand-3: #00d68f; /* mint */
        --danger: #ef476f;
        --ok: #06d6a0;
        --card: #ffffff;
        --shadow: 0 10px 30px rgba(22, 33, 62, 0.08);
        --radius: 16px;
      }
      *{box-sizing:border-box}
      html,body{height:100%}
      body{
        margin:0;
        background:
          radial-gradient(1200px 600px at 10% -10%, rgba(108,92,231,.15), transparent),
          radial-gradient(1000px 800px at 110% 20%, rgba(0,200,255,.12), transparent),
          radial-gradient(900px 700px at 50% 120%, rgba(0,214,143,.12), transparent),
          var(--bg);
        color:var(--ink);
        font-family: "Nunito", system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
        line-height:1.5;
      }
      header{
        position:sticky; top:0; z-index:5;
        background:rgba(255,255,255,.75);
        backdrop-filter: blur(6px);
        border-bottom:1px solid rgba(0,0,0,.05);
      }
      .wrap{max-width:1000px; margin:0 auto; padding:16px;}
      .row{display:flex; align-items:center; gap:12px; flex-wrap:wrap}
      .brand{
        display:flex; align-items:center; gap:12px; font-weight:900; letter-spacing:.3px;
      }
      .brand .logo{
        width:40px; height:40px; border-radius:50%;
        display:grid; place-items:center; color:white;
        background: linear-gradient(135deg, var(--brand), var(--brand-2));
        box-shadow: var(--shadow);
        font-family: "Fredoka", sans-serif; font-weight:700;
      }
      .spacer{flex:1}
      .pill{font-weight:700; font-size:14px; padding:8px 12px; border-radius:999px; background:#f1f5f9; color:#0f172a}

      button{
        border:0; cursor:pointer; font-weight:800; letter-spacing:.3px;
        border-radius:12px; padding:14px 18px; transition: transform .06s ease, box-shadow .2s ease;
        background: linear-gradient(135deg, var(--brand), var(--brand-2));
        color:white; box-shadow: var(--shadow);
      }
      button:hover{ transform: translateY(-1px) }
      button.secondary{ background:#eef2ff; color:#3730a3 }
      button.ghost{ background:transparent; color:var(--ink); box-shadow:none; }

      main{ padding:32px 16px; }

      .grid{
        display:grid; gap:24px; grid-template-columns: 1.1fr .9fr; align-items:stretch;
      }
      @media (max-width: 860px){ .grid{ grid-template-columns: 1fr } }

      .card{
        background:var(--card); border-radius:var(--radius); box-shadow: var(--shadow);
        padding:20px; overflow:hidden;
      }

      .welcome{
        display:grid; gap:16px;
      }
      .big-title{ font-family:"Fredoka", sans-serif; font-weight:800; font-size: clamp(28px, 4vw, 44px); line-height:1.1 }
      .subtitle{ color:var(--muted); font-size:18px }

      .auth-form label{ display:block; font-weight:800; margin:12px 0 4px }
      .auth-form input{
        width:100%; padding:14px 16px; border-radius:12px; border:2px solid #e2e8f0;
        font-size:16px; outline: none; transition: border-color .2s ease;
        background:#f8fafc;
      }
      .auth-form input:focus{ border-color: var(--brand) }
      .hint{ color:var(--muted); font-size:14px }
      .error{ color:var(--danger); font-weight:800 }

      .pet{
        display:flex; align-items:center; gap:16px;
      }
      .pet .bubble{
        width:80px; height:80px; border-radius:20px; display:grid; place-items:center;
        font-size:40px; background: linear-gradient(135deg, #fff, #f5f3ff);
        border:2px dashed #e9d5ff;
      }
      .level-box{ font-weight:800 }
      .xpbar{
        height:12px; background:#e2e8f0; border-radius:999px; overflow:hidden;
      }
      .xpbar > span{ display:block; height:100%; width:0%; background: linear-gradient(90deg, var(--brand), var(--brand-3)); transition: width .5s ease }

      .quiz{
        display:grid; gap:18px;
      }
      .question{ font-size:20px; font-weight:800 }
      .options{ display:grid; gap:10px }
      .opt{
        display:flex; align-items:center; gap:10px; padding:12px; border-radius:12px; background:#f8fafc; border:2px solid #e2e8f0;
      }
      .opt input{ transform: scale(1.2) }

      .muted{ color:var(--muted) }
      .small{ font-size:13px }
      .center{ text-align:center }
    </style>
  </head>
  <body>
    <header>
      <div class="wrap row">
        <div class="brand">
          <div class="logo">ES</div>
          <div>
            Project ESBLAG
            <div class="small muted">Education Should Be Like A Game</div>
          </div>
        </div>
        <div class="spacer"></div>
        <div id="userBadge" class="pill" style="display:none"></div>
        <button id="logoutBtn" class="ghost" style="display:none">Log ud</button>
      </div>
    </header>

    <main class="wrap">
      <!-- SECTION: Welcome (shown when logged in) -->
      <section id="welcome" style="display:none">
        <div class="grid">
          <div class="card welcome">
            <div class="big-title">Velkommen, <span id="welcomeName">ven</span>! üéâ</div>
            <div class="subtitle">L√¶ring skal f√∏les som et spil. Tjen XP for rigtige svar, g√• op i level ‚Äî og se dit lille l√¶rings-k√¶ledyr udvikle sig!</div>
            <div class="pet">
              <div class="bubble" id="petEmoji" aria-label="Dit l√¶rings-k√¶ledyr">üê£</div>
              <div>
                <div class="level-box">Level <span id="levelText">1</span></div>
                <div class="xpbar" aria-label="XP fremgang">
                  <span id="xpFill" style="width:0%"></span>
                </div>
                <div class="small muted" id="xpLabel">0 / 50 XP til n√¶ste level</div>
              </div>
            </div>
            <div class="row" style="margin-top:8px">
              <button id="startQuizBtn">Start quiz</button>
              <button class="secondary" id="aboutBtn">Hvad er dette?</button>
            </div>
            <div class="small muted">PS: Denne prototype gemmer kun p√• din egen enhed (localStorage).</div>
          </div>

          <div class="card">
            <h3 style="margin-top:0">Hurtig info</h3>
            <ul>
              <li>10 sp√∏rgsm√•l ‚Ä¢ multiple choice</li>
              <li>+10 XP pr. rigtigt svar</li>
              <li>50 XP = nyt level</li>
            </ul>
            <p class="muted small">Tip til l√¶rere/for√¶ldre: indhold kan nemt udskiftes i koden (se QUESTIONS i JavaScript).
            </p>
          </div>
        </div>
      </section>

      <!-- SECTION: About (simple explainer) -->
      <section id="about" style="display:none">
        <div class="card">
          <h2 style="margin-top:0">Hvad er Project ESBLAG?</h2>
          <p>En enkel MVP, der viser hvordan gamification kan g√∏re l√¶ring sjovere: point (XP), levels og et lille k√¶ledyr, der udvikler sig. Alt er bygget i ren HTML, CSS og JavaScript.</p>
          <button class="secondary" id="backHomeBtn">Tilbage</button>
        </div>
      </section>

      <!-- SECTION: Auth (shown when logged out / first visit) -->
      <section id="auth" style="display:none">
        <div class="grid">
          <div class="card">
            <h2 class="big-title" style="margin-top:0">Kom i gang ‚ú®</h2>
            <p class="subtitle">Opret en profil med dit navn og alder. Det hj√¶lper os med at tilpasse oplevelsen.</p>
            <form id="authForm" class="auth-form" autocomplete="off">
              <label for="name">Hvad hedder du?</label>
              <input id="name" name="name" required minlength="2" maxlength="24" placeholder="Skriv dit fornavn" />

              <label for="age">Hvor gammel er du?</label>
              <input id="age" name="age" type="number" required min="8" max="99" placeholder="Fx 13" />

              <div class="hint">M√•lgruppen er ca. 10‚Äì16 √•r, men alle er velkomne i demoen üòä</div>
              <div id="authError" class="error" style="display:none"></div>
              <div class="row" style="margin-top:14px">
                <button type="submit">Start</button>
                <button type="reset" class="ghost" id="authReset">Ryd</button>
              </div>
            </form>
          </div>

          <div class="card">
            <h3 style="margin-top:0">Hvorfor s√• simpelt?</h3>
            <p>Det er en prototype. Vi holder det enkelt, s√• vi hurtigt kan teste id√©en og bygge videre: flere quizzer, badges, klasse-lister, l√¶reroverblik og meget mere.</p>
          </div>
        </div>
      </section>

      <!-- SECTION: Quiz -->
      <section id="quiz" style="display:none">
        <div class="card">
          <div class="row" style="justify-content:space-between; align-items:center">
            <div><strong>Quiz</strong> ‚Ä¢ <span id="qProgress">1 / 10</span></div>
            <div class="small muted">+10 XP pr. rigtigt svar</div>
          </div>
          <div class="quiz" style="margin-top:16px">
            <div id="qText" class="question">Sp√∏rgsm√•lstekst</div>
            <div id="qOptions" class="options"></div>
            <div class="row">
              <button id="nextBtn">N√¶ste</button>
              <button id="cancelQuizBtn" class="ghost">Afbryd</button>
            </div>
          </div>
        </div>
      </section>

      <!-- SECTION: Result -->
      <section id="result" style="display:none">
        <div class="card center">
          <h2 style="margin-top:0">Flot klaret! üéØ</h2>
          <p>Du fik <strong><span id="correctCount">0</span>/<span id="totalCount">0</span></strong> rigtige.</p>
          <p>Du tjente <strong><span id="xpEarned">0</span> XP</strong>.</p>
          <div style="max-width:420px; margin: 0 auto 16px">
            <div class="pet" style="justify-content:center">
              <div class="bubble" id="petEmojiResult">üê£</div>
              <div>
                <div class="level-box">Level <span id="levelTextResult">1</span></div>
                <div class="xpbar"><span id="xpFillResult"></span></div>
                <div class="small muted" id="xpLabelResult">0 / 50 XP til n√¶ste level</div>
              </div>
            </div>
          </div>
          <div class="row" style="justify-content:center; gap:10px">
            <button id="retryBtn">Pr√∏v quizzen igen</button>
            <button class="secondary" id="homeBtn">Til velkomst</button>
          </div>
        </div>
      </section>
    </main>

    <script>
      // ===============================
      // Simple State & Utilities
      // ===============================

      /**
       * The single source of truth for a logged-in user. Saved to localStorage.
       * { name: string, age: number, xp: number }
       */
      let currentUser = null;

      const STORAGE_KEY = 'esblag_user_v1';
      const XP_PER_CORRECT = 10;     // award 10 XP per correct answer
      const XP_PER_LEVEL = 50;       // 50 XP for each level-up

      /** Load user from localStorage, if present */
      function loadUser(){
        try{
          const raw = localStorage.getItem(STORAGE_KEY);
          if(!raw) return null;
          return JSON.parse(raw);
        }catch(e){
          console.error('Failed to parse user from storage', e);
          return null;
        }
      }
      /** Save user to localStorage */
      function saveUser(){
        localStorage.setItem(STORAGE_KEY, JSON.stringify(currentUser));
      }
      /** Log the user out */
      function logout(){
        localStorage.removeItem(STORAGE_KEY);
        currentUser = null;
        // Return to auth screen
        showSection('auth');
        updateHeader();
      }

      /** Compute the user's level from XP */
      function getLevel(xp){
        // Level starts at 1; every 50 XP -> +1 level
        return Math.floor(xp / XP_PER_LEVEL) + 1;
      }
      /** XP already gained into the current level (0..XP_PER_LEVEL) */
      function getXPIntoLevel(xp){
        return xp % XP_PER_LEVEL;
      }
      /** Percentage toward next level (0..100) */
      function getXPPercent(xp){
        return Math.round(100 * getXPIntoLevel(xp) / XP_PER_LEVEL);
      }

      /** Choose a pet emoji based on level */
      function petForLevel(level){
        if(level <= 1) return 'üê£';
        if(level <= 3) return 'üê•';
        if(level <= 5) return 'üê¶';
        if(level <= 8) return 'ü¶Ö';
        return 'üêâ'; // endgame imagination üòÑ
      }

      /** Update the header UI */
      function updateHeader(){
        const badge = document.getElementById('userBadge');
        const logoutBtn = document.getElementById('logoutBtn');
        if(currentUser){
          const lvl = getLevel(currentUser.xp);
          badge.textContent = `${currentUser.name} ‚Ä¢ ${currentUser.age} √•r ‚Ä¢ Lvl ${lvl}`;
          badge.style.display = '';
          logoutBtn.style.display = '';
        }else{
          badge.style.display = 'none';
          logoutBtn.style.display = 'none';
        }
      }

      /** Update pet + level widgets (welcome + result) */
      function updatePetWidgets(){
        if(!currentUser) return;
        const level = getLevel(currentUser.xp);
        const percent = getXPPercent(currentUser.xp);
        const into = getXPIntoLevel(currentUser.xp);

        // Welcome section
        document.getElementById('welcomeName').textContent = currentUser.name;
        document.getElementById('petEmoji').textContent = petForLevel(level);
        document.getElementById('levelText').textContent = level;
        document.getElementById('xpFill').style.width = percent + '%';
        document.getElementById('xpLabel').textContent = `${into} / ${XP_PER_LEVEL} XP til n√¶ste level`;

        // Result section (mirrors state)
        document.getElementById('petEmojiResult').textContent = petForLevel(level);
        document.getElementById('levelTextResult').textContent = level;
        document.getElementById('xpFillResult').style.width = percent + '%';
        document.getElementById('xpLabelResult').textContent = `${into} / ${XP_PER_LEVEL} XP til n√¶ste level`;
      }

      /** Show one of the app sections by id */
      function showSection(id){
        ['welcome','auth','quiz','result','about'].forEach(sec => {
          document.getElementById(sec).style.display = (sec === id) ? '' : 'none';
        });
      }

      // ===============================
      // Quiz Engine (very simple)
      // ===============================

      /**
       * Replace this array to change quiz content.
       * Each question: { text: string, options: string[], correctIndex: number }
       */
      const QUESTIONS = [
        { text: 'Hvad er 7 + 5?', options: ['10','12','13','14'], correctIndex: 1 },
        { text: 'Hvilken planet kaldes den r√∏de planet?', options: ['Venus','Jorden','Mars','Saturn'], correctIndex: 2 },
        { text: 'Hvad hedder Danmarks hovedstad?', options: ['Aarhus','K√∏benhavn','Odense','Esbjerg'], correctIndex: 1 },
        { text: 'Hvilket sprog taler man i Spanien?', options: ['Fransk','Italiensk','Spansk','Tysk'], correctIndex: 2 },
        { text: 'Hvor mange minutter er der i en time?', options: ['30','45','60','90'], correctIndex: 2 },
        { text: 'Hvad kaldes resultatet af et multiplikationsstykke?', options: ['Sum','Kvotient','Produkt','Differens'], correctIndex: 2 },
        { text: 'Hvilket dyr er kendt for at have en lang hals?', options: ['Giraf','Hest','Kanin','Krokodille'], correctIndex: 0 },
        { text: 'Hvad er vandets frysepunkt i ¬∞C?', options: ['0¬∞C','10¬∞C','-10¬∞C','32¬∞C'], correctIndex: 0 },
        { text: 'Hvilket hav ligger mellem Europa og Afrika?', options: ['Stillehavet','Middelhavet','Atlanten','Det Indiske Ocean'], correctIndex: 1 },
        { text: 'Hvad er 9 √ó 3?', options: ['18','21','27','36'], correctIndex: 2 },
      ];

      let qIndex = 0;               // current question index
      let selections = [];           // selected answer indices

      function startQuiz(){
        qIndex = 0;
        selections = new Array(QUESTIONS.length).fill(null);
        renderQuestion();
        showSection('quiz');
      }

      function renderQuestion(){
        const q = QUESTIONS[qIndex];
        document.getElementById('qText').textContent = q.text;
        document.getElementById('qProgress').textContent = `${qIndex+1} / ${QUESTIONS.length}`;

        const box = document.getElementById('qOptions');
        box.innerHTML = '';
        q.options.forEach((opt, i) => {
          // unique id for input/label pairing
          const id = `opt-${qIndex}-${i}`;
          const wrap = document.createElement('label');
          wrap.className = 'opt';
          wrap.htmlFor = id;
          wrap.innerHTML = `
            <input type="radio" name="q${qIndex}" id="${id}" ${selections[qIndex]===i?'checked':''} />
            <span>${opt}</span>
          `;
          wrap.querySelector('input').addEventListener('change', () => {
            selections[qIndex] = i;
          });
          box.appendChild(wrap);
        });

        // Update next button text for final question
        document.getElementById('nextBtn').textContent = (qIndex === QUESTIONS.length - 1) ? 'Afslut' : 'N√¶ste';
      }

      function nextQuestion(){
        // If nothing chosen, we still allow moving on (MVP), but you can enforce selection if desired
        if(qIndex < QUESTIONS.length - 1){
          qIndex++;
          renderQuestion();
        }else{
          finishQuiz();
        }
      }

      function finishQuiz(){
        // Calculate score
        let correct = 0;
        QUESTIONS.forEach((q, i) => {
          if(selections[i] === q.correctIndex) correct++;
        });
        const earned = correct * XP_PER_CORRECT;

        // Update user XP
        currentUser.xp = (currentUser.xp || 0) + earned;
        saveUser();

        // Update result UI
        document.getElementById('correctCount').textContent = correct;
        document.getElementById('totalCount').textContent = QUESTIONS.length;
        document.getElementById('xpEarned').textContent = earned;

        updateHeader();
        updatePetWidgets();
        showSection('result');
      }

      // ===============================
      // Event Wiring
      // ===============================
      const logoutBtn = document.getElementById('logoutBtn');
      logoutBtn.addEventListener('click', logout);

      // Auth form handling
      const authForm = document.getElementById('authForm');
      const authError = document.getElementById('authError');
      authForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const name = authForm.name.value.trim();
        const age = parseInt(authForm.age.value, 10);

        // Basic validation
        if(!name || !Number.isFinite(age)){
          authError.textContent = 'Udfyld venligst navn og alder.';
          authError.style.display = '';
          return;
        }
        if(age < 8 || age > 99){
          authError.textContent = 'Alderen virker forkert. Pr√∏v igen.';
          authError.style.display = '';
          return;
        }
        authError.style.display = 'none';

        currentUser = { name, age, xp: 0 };
        saveUser();
        updateHeader();
        updatePetWidgets();
        showSection('welcome');
      });
      document.getElementById('authReset').addEventListener('click', () => {
        authError.style.display = 'none';
      });

      // Welcome actions
      document.getElementById('startQuizBtn').addEventListener('click', startQuiz);
      document.getElementById('aboutBtn').addEventListener('click', () => showSection('about'));
      document.getElementById('backHomeBtn').addEventListener('click', () => showSection('welcome'));

      // Quiz actions
      document.getElementById('nextBtn').addEventListener('click', nextQuestion);
      document.getElementById('cancelQuizBtn').addEventListener('click', () => {
        showSection('welcome');
      });

      // Result actions
      document.getElementById('retryBtn').addEventListener('click', startQuiz);
      document.getElementById('homeBtn').addEventListener('click', () => showSection('welcome'));

      // ===============================
      // App Init
      //just an extra line aka test
      
      // ===============================
      function init(){
        const existing = loadUser();
        if(existing){
          currentUser = existing;
          updateHeader();
          updatePetWidgets();
          showSection('welcome');
        }else{
          showSection('auth');
        }
        // Prepare first question content so the DOM is ready
        renderQuestion();
      }
      init();
    </script>
  </body>
</html>

